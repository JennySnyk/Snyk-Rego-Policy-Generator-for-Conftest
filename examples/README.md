# Example Rego Policies

This directory contains example Rego policies generated by the enhanced rego-policy-generator, demonstrating the new features.

## Examples

### 1. fix-availability-policy.rego
**Use Case**: Enforce that teams apply available security fixes

This policy fails the build if there are more than 5 vulnerabilities with available upgrades. This encourages teams to apply fixes that are readily available.

**Test with**:
```bash
snyk test --json your-project | conftest test --policy examples/fix-availability-policy.rego -
```

### 2. cvss-score-policy.rego
**Use Case**: Flag high-severity vulnerabilities based on industry-standard CVSS scores

This policy fails if any vulnerabilities with CVSS score >= 7.5 are found, providing a more granular control than just using severity levels.

**Test with**:
```bash
snyk test --json your-project | conftest test --policy examples/cvss-score-policy.rego -
```

### 3. cve-specific-policy.rego
**Use Case**: Block specific CVEs (e.g., Log4Shell)

This policy checks for specific Log4j-related CVEs and fails on any occurrence. Useful for ensuring critical vulnerabilities like Log4Shell are not present in your dependencies.

**Test with**:
```bash
snyk test --json your-project | conftest test --policy examples/cve-specific-policy.rego -
```

### 4. combined-policy.rego
**Use Case**: Comprehensive security policy with multiple criteria

This policy combines multiple checks:
- Fails on any critical severity vulnerabilities
- Fails if there are more than 10 high severity vulnerabilities
- Warns about vulnerabilities without available fixes (threshold: 20)
- Flags vulnerabilities with CVSS score >= 8.0

**Test with**:
```bash
snyk test --json your-project | conftest test --policy examples/combined-policy.rego -
```

## Creating Your Own Policies

To generate your own custom policy, run:

```bash
cd ..
./rego-policy-generator
```

Follow the interactive prompts to select your desired policy options.

## Notes

- All these examples work with Snyk Open Source and Snyk Container (with `--json` flag)
- For Snyk Code, use the `--sarif` output format instead
- You can combine multiple policies in a single file or use multiple policy files with conftest

